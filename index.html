<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plant Watering System</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
      rel="stylesheet"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="styles.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.6.1/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  </head>
  <body>
    <div class="container-fluid p-0">
      <nav class="navbar navbar-dark navbar-expand-lg">
        <div class="container-fluid">
          <a class="navbar-brand text-shadow" href="#">Plant Watering System</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarNav"
            aria-controls="navbarNav"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto admin-nav">
              <li class="nav-item">
                <a
                  class="nav-link active"
                  href="#"
                  data-group="1"
                  aria-label="Switch to Group 1"
                  >Group 1</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#"
                  data-group="2"
                  aria-label="Switch to Group 2"
                  >Group 2</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#"
                  data-group="3"
                  aria-label="Switch to Group 3"
                  >Group 3</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="#"
                  data-group="4"
                  aria-label="Switch to Group 4"
                  >Group 4</a
                >
              </li>
              <li class="nav-item admin-only">
                <a
                  class="nav-link"
                  href="#"
                  data-bs-toggle="modal"
                  data-bs-target="#settingsModal"
                  >Settings</a
                >
              </li>
              <li class="nav-item admin-only" id="logs-nav">
                <a class="nav-link" href="#" data-group="logs">Logs</a>
              </li>
              <li class="nav-item">
                <button id="logout-btn" class="btn">Logout</button>
              </li>
            </ul>
          </div>
        </div>
      </nav>

      <div class="modal fade" id="settingsModal" tabindex="-1">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title">Settings</h5>
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Close"
              ></button>
            </div>
            <div class="modal-body">
              <div class="mb-3">
                <label class="form-check-label">Dark Mode</label>
                <input
                  type="checkbox"
                  class="form-check-input"
                  id="dark-mode-toggle"
                />
              </div>
              <div class="mb-3">
                <label for="refresh-interval" class="form-label"
                  >Refresh Interval</label
                >
                <select class="form-select" id="refresh-interval">
                  <option value="5000">5 seconds</option>
                  <option value="10000">10 seconds</option>
                </select>
              </div>
              <div class="mb-3 admin-only" id="plant-name-settings">
                <label>Plant Names</label>
                <div>
                  <input
                    type="text"
                    class="form-control mb-2"
                    id="plant-name-1-input"
                    placeholder="Group 1 Plant"
                  />
                  <input
                    type="text"
                    class="form-control mb-2"
                    id="plant-name-2-input"
                    placeholder="Group 2 Plant"
                  />
                  <input
                    type="text"
                    class="form-control mb-2"
                    id="plant-name-3-input"
                    placeholder="Group 3 Plant"
                  />
                  <input
                    type="text"
                    class="form-control mb-2"
                    id="plant-name-4-input"
                    placeholder="Group 4 Plant"
                  />
                </div>
              </div>
            </div>
            <div class="modal-footer">
              <button
                type="button"
                class="btn btn-secondary"
                data-bs-dismiss="modal"
              >
                Close
              </button>
              <button type="button" class="btn btn-primary" id="save-settings">
                Save
              </button>
            </div>
          </div>
        </div>
      </div>

      <div class="container mt-4" id="dashboard" style="display: none">
        <h1 id="plant-name" class="text-center mb-4">Cactus Dashboard</h1>

        <div id="loading-spinner" class="d-none">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
        </div>

        <div id="sensor-data" class="row g-4">
          <div class="col-md-4">
            <div class="card gauge-card">
              <div class="card-body text-center">
                <h5>Soil Moisture</h5>
                <canvas id="soil-moisture-gauge"></canvas>
                <h3 id="soil-moisture">0%</h3>
                <i class="fas fa-tint" aria-hidden="true"></i>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card gauge-card">
              <div class="card-body text-center">
                <h5>Temperature</h5>
                <canvas id="temperature-gauge"></canvas>
                <h3 id="temperature">0°C</h3>
                <i class="fas fa-thermometer-half" aria-hidden="true"></i>
              </div>
            </div>
          </div>
          <div class="col-md-4">
            <div class="card gauge-card">
              <div class="card-body text-center">
                <h5>Humidity</h5>
                <canvas id="humidity-gauge"></canvas>
                <h3 id="humidity">0%</h3>
                <i class="fas fa-water" aria-hidden="true"></i>
              </div>
            </div>
          </div>
        </div>

        <div id="controls" class="row g-4 mt-4">
          <div class="col-md-6">
            <div class="card control-card">
              <div class="card-body text-center">
                <h5>
                  <span id="pump-status">Pump: OFF</span>
                </h5>
                <button
                  id="pump-btn"
                  class="btn btn-outline-primary control-btn"
                  data-active="false"
                  aria-label="Toggle water pump, currently OFF"
                >
                  <i class="fas fa-tint"></i>
                </button>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card control-card">
              <div class="card-body text-center">
                <h5>
                  <span id="light-status">Light: OFF</span>
                </h5>
                <button
                  id="light-btn"
                  class="btn btn-outline-warning control-btn"
                  data-active="false"
                  aria-label="Toggle light, currently OFF"
                >
                  <i class="fas fa-lightbulb"></i>
                </button>
              </div>
            </div>
          </div>
        </div>

        <div class="mt-4 text-center">
          <p>
            Last updated:
            <span id="last-updated">Never</span>
          </p>
          <button id="refresh-btn" class="btn btn-primary">
            Refresh
          </button>
        </div>

        <div id="logs" class="mt-4" style="display: none">
          <h2>System Logs</h2>
          <div class="input-group mb-3">
            <input
              type="text"
              class="form-control"
              id="log-filter"
              placeholder="Filter logs..."
            />
            <select class="form-select admin-only" id="log-group-filter">
              <option value="all">All Groups</option>
              <option value="1">Group 1</option>
              <option value="2">Group 2</option>
              <option value="3">Group 3</option>
              <option value="4">Group 4</option>
            </select>
          </div>
          <ul id="log-list" class="list-group"></ul>
        </div>
      </div>

      <div id="login-container" class="hero-section p-5 text-center">
        <h1 class="display-4 text-shadow">Plant Watering System</h1>
        <div class="mt-4">
          <form id="login-form">
            <div class="mb-3">
              <input
                type="text"
                class="form-control"
                id="username"
                placeholder="Username"
                required
              />
            </div>
            <div class="mb-3">
              <input
                type="password"
                class="form-control"
                id="password"
                placeholder="Password"
                required
              />
            </div>
            <button type="submit" class="btn btn-primary">Login</button>
          </form>
        </div>
      </div>

      <div id="feedback" class="alert d-none" role="alert"></div>
      <div id="error-message" class="alert alert-danger d-none" role="alert"></div>
      <div
        class="toast position-fixed top-0 end-0 m-3"
        id="error-toast"
        role="alert"
        aria-live="assertive"
        aria-atomic="true"
      >
        <div class="toast-header">
          <strong class="me-auto">Error</strong>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="toast"
            aria-label="Close"
          ></button>
        </div>
        <div class="toast-body"></div>
      </div>
    </div>

    <footer class="text-center py-3 mt-5">
      Plant Watering System © 2025 | Powered by Derwin Lagmay
    </footer>

    <script src="script.js" defer></script>
  </body>
</html>